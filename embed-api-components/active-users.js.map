{"version":3,"sources":["webpack:///webpack/bootstrap 717bd62df027c4c38d49","webpack:///./src/javascript/embed-api/components/active-users.js"],"names":[],"mappings":"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","file":"active-users.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 717bd62df027c4c38d49\n **/","// Copyright 2015 Google Inc. All rights reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n/* global gapi */\n\n\ngapi.analytics.ready(function() {\n\n  gapi.analytics.createComponent('ActiveUsers', {\n\n    initialize: function() {\n      this.activeUsers = 0;\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    execute: function() {\n      // Stop any polling currently going on.\n      if (this.polling_) {\n        this.stop();\n      }\n\n      this.render_();\n\n      // Wait until the user is authorized.\n      if (gapi.analytics.auth.isAuthorized()) {\n        this.pollActiveUsers_();\n      }\n      else {\n        gapi.analytics.auth.once('signIn', this.pollActiveUsers_.bind(this));\n      }\n    },\n\n    stop: function() {\n      clearTimeout(this.timeout_);\n      this.polling_ = false;\n      this.emit('stop', {activeUsers: this.activeUsers});\n    },\n\n    render_: function() {\n      let opts = this.get();\n\n      // Render the component inside the container.\n      this.container = typeof opts.container == 'string' ?\n          document.getElementById(opts.container) : opts.container;\n\n      this.container.innerHTML = opts.template || this.template;\n      this.container.querySelector('b').innerHTML = this.activeUsers;\n    },\n\n    pollActiveUsers_: function() {\n      let options = this.get();\n      let pollingInterval = (options.pollingInterval || 5) * 1000;\n\n      if (isNaN(pollingInterval) || pollingInterval < 5000) {\n        throw new Error('Frequency must be 5 seconds or more.');\n      }\n\n      this.polling_ = true;\n      gapi.client.analytics.data.realtime\n          .get({ids: options.ids, metrics: 'rt:activeUsers'})\n          .then(function(response) {\n\n        let result = response.result;\n        let newValue = result.totalResults ? +result.rows[0][0] : 0;\n        let oldValue = this.activeUsers;\n\n        this.emit('success', {activeUsers: this.activeUsers});\n\n        if (newValue != oldValue) {\n          this.activeUsers = newValue;\n          this.onChange_(newValue - oldValue);\n        }\n\n        if (this.polling_ == true) {\n          this.timeout_ = setTimeout(this.pollActiveUsers_.bind(this),\n              pollingInterval);\n        }\n      }.bind(this));\n    },\n\n    onChange_: function(delta) {\n      let valueContainer = this.container.querySelector('b');\n      if (valueContainer) valueContainer.innerHTML = this.activeUsers;\n\n      this.emit('change', {activeUsers: this.activeUsers, delta: delta});\n      if (delta > 0) {\n        this.emit('increase', {activeUsers: this.activeUsers, delta: delta});\n      }\n      else {\n        this.emit('decrease', {activeUsers: this.activeUsers, delta: delta});\n      }\n    },\n\n    handleSignOut_: function() {\n      this.stop();\n      gapi.analytics.auth.once('signIn', this.handleSignIn_.bind(this));\n    },\n\n    handleSignIn_: function() {\n      this.pollActiveUsers_();\n      gapi.analytics.auth.once('signOut', this.handleSignOut_.bind(this));\n    },\n\n    template:\n      '<div class=\"ActiveUsers\">' +\n        'Active Users: <b class=\"ActiveUsers-value\"></b>' +\n      '</div>'\n\n  });\n\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/javascript/embed-api/components/active-users.js\n **/"],"sourceRoot":""}